<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
<title>루카와 마르카 : 지구탈출연구실 - STAGE 1</title>
<style>
  html, body {
    margin: 0; padding: 0; height: 100%;
    background: #000; overflow: hidden;
    touch-action: none;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  }
  canvas { position:absolute; inset:0; width:100vw; height:100vh; }

.topbar{
  position:absolute;
  left:10px; right:10px;

  /* ✅ 위가 아니라 아래로 */
  bottom:max(10px, env(safe-area-inset-bottom));
  top:auto;

  display:flex;
  justify-content:space-between;
  gap:10px;

  pointer-events:none;
  z-index:30; /* HUD 위/아래 조정용 */
}
.btn{
  pointer-events:auto;
  flex:1;               /* ✅ 버튼 3개가 균등하게 */
  text-align:center;
  padding:10px 12px;
  border-radius:14px;
  background: rgba(12,16,28,0.70);
  border:1px solid rgba(42,49,67,0.9);
  color:#e8f2ff;
  font-weight:900;
  font-size:12px;
  user-select:none; -webkit-user-select:none;
  touch-action:none;
}
  .btn:active{ transform: translateY(1px); }

  .startLayer{
    position:absolute; inset:0;
    display:flex; align-items:center; justify-content:center;
    background: rgba(0,0,0,0.45);
    z-index:20;
    touch-action:none;
  }
  .card{
    width:min(420px, 92vw);
    background: rgba(0,0,0,0.55);
    border:1px solid rgba(255,255,255,0.15);
    border-radius:18px;
    padding:18px 16px;
    color:#e8f2ff;
    text-align:center;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
  }
  .card .t{ font-weight:950; font-size:18px; margin-bottom:8px; }
  .card .s{ font-size:13px; opacity:0.85; line-height:1.35; }
  .card .logo{ margin-top:10px; font-weight:900; letter-spacing:1px; color:#76d2c8; font-size:13px; }
</style>
</head>
<body>

<canvas id="game"></canvas>

<div class="topbar">
  <div class="btn" id="btnSwap">SWAP (루카/마르카)</div>
  <div class="btn" id="btnBgm">BGM: ON</div>
  <div class="btn" id="btnRestart">RESTART</div>
</div>

<div class="startLayer" id="startLayer">
  <div class="card">
    <div class="t">루카와 마르카 : 지구탈출연구실</div>
    <div class="s">STAGE 1 · 세로 슈팅 데모<br/>드래그 이동 · 자동 발사</div>
    <div class="logo">TERRA ESCAPE LAB</div>
  </div>
</div>

<script src="js/engine.js"></script>
<script src="js/stage1.js"></script>
<script>
  // Stage1 로드 후 엔진 시작
<script>
  // ✅ 엔진이 로드한 스프라이트를 Stage에서 접근 가능하게 전달
  window.__TEL_SPRITES__ = null;
</script>

<script>
  // Stage1 로드 후 엔진 시작
  // engine이 내부에서 만든 sprites를 stage에서 쓰기 위해 전역에 꽂아줌
  const _origStart = TEL.start;
  TEL.start = (stage) => {
    // start 내부에서 sprites를 만들기 전에 stage.sprites를 보관해뒀다가,
    // engine.js를 크게 안 건드리기 위한 “얕은 연결”
    _origStart(stage);
  };
  TEL.start(Stage1);
</script>
</script>
</body>
</html>
